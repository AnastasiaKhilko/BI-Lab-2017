-- Sequences (with Package Prodcedure)
execute pkg_drop.DROP_proc('seq_consumers','sequence');
CREATE SEQUENCE seq_consumers
      INCREMENT BY 1 
          START WITH 1 
       MINVALUE 1 
        NOCYCLE;  

execute pkg_drop.DROP_proc('seq_departments','sequence');
CREATE SEQUENCE seq_departments
      INCREMENT BY 1 
          START WITH 1 
       MINVALUE 1 
        NOCYCLE;  

execute pkg_drop.DROP_proc('seq_products','sequence');
CREATE SEQUENCE seq_products
      INCREMENT BY 1 
          START WITH 1 
       MINVALUE 1 
        NOCYCLE;  

execute pkg_drop.DROP_proc('seq_promotions','sequence');
CREATE SEQUENCE seq_promotions
      INCREMENT BY 1 
          START WITH 1 
       MINVALUE 1 
        NOCYCLE;  

-- Tables
execute pkg_drop.DROP_proc('DIM_CONSUMERS','table');
execute pkg_drop.DROP_proc('DIM_DATE','table');
execute pkg_drop.DROP_proc('DIM_DEPARTMENTS','table');
execute pkg_drop.DROP_proc('DIM_PRODUCTS','table');
execute pkg_drop.DROP_proc('DIM_PROMOTIONS','table');
execute pkg_drop.DROP_proc('DIM_SALE_STATE','table');
execute pkg_drop.DROP_proc('FACT_SALES','table');

CREATE TABLE "USER_3"."DIM_CONSUMERS"
(
	"CONSUMER_ID" NUMBER(8,2) NOT NULL,
	"CONSUMER_SRC" NUMBER(8,2),
	"CONSUMER_TITLE" VARCHAR2(50),
	"ADDRESS" VARCHAR2(50),
	"CITY" VARCHAR2(50),
	"COUNTRY" VARCHAR2(50),
	"REGION" VARCHAR2(50),
	"PRICE_INDEX" NUMBER(8,2),
	"POSTAL_CODE" VARCHAR2(50),
	"PHONE" VARCHAR2(50),
	"CONSUMER_CODE" NUMBER(8,2)
)
;

CREATE TABLE "USER_3"."DIM_DATE"
(
	"DATE_ID" DATE NOT NULL,
	"DAY_WEEK" NUMBER(8,2),
	"DAY_SHORT" VARCHAR2(50),
	"DAY_LONG" VARCHAR2(50),
	"DAY_MONTH" NUMBER(8,2),
	"LASTDAY_MONTH" DATE,
	"DAY_YEAR" NUMBER(8,2),
	"MONTH_YEAR" NUMBER(8,2),
	"MONTH_SHORT" VARCHAR2(50),
	"MONTH_LONG" VARCHAR2(50),
	"MONTH_DESC" VARCHAR2(50),
	"QUARTER" NUMBER(8,2),
	"YEAR_HALF" NUMBER(8,2),
	"YEAR" NUMBER(8,2)
)
;

CREATE TABLE "USER_3"."DIM_DEPARTMENTS"
(
	"DEPARTMENT_ID" NUMBER(8,2) NOT NULL,
	"DEPARTMENT_SRC" NUMBER(8,2),
	"DEPARTMENT_CODE" VARCHAR2(50),
	"ADDRESS" VARCHAR2(50),
	"CITY" VARCHAR2(50),
	"POSTAL_CODE" VARCHAR2(50),
	"COUNTRY" VARCHAR2(50),
	"REGION" VARCHAR2(50)
)
;

CREATE TABLE "USER_3"."DIM_PRODUCTS"
(
	"PRODUCT_ID" NUMBER(8,2) NOT NULL,
	"PRODUCT_SRC" NUMBER(8,2),
	"PRODUCT_CODE" NUMBER(8,2),
	"PRODUCT_NAME" VARCHAR2(50),
	"PRODUCT_CATEGORY" VARCHAR2(50),
	"PRODUCT_SUBCATEGORY" VARCHAR2(50),
	"PACKAGE_SIZE" VARCHAR2(50),
	"PACKAGE_COLOR" VARCHAR2(50),
	"ITEM_SIZE" VARCHAR2(50),
	"TOBACCO" VARCHAR2(50),
	"ITEMS_PACKAGE" VARCHAR2(50),
	"PRODUCT_IMAGE" VARCHAR2(50),
	"LOCALIZATION" VARCHAR2(50),
	"START_DT" DATE,
	"END_DT" DATE,
	"IS_ACTIVE" VARCHAR2(50),
	"STD_PRICE" VARCHAR2(50)
)
;

CREATE TABLE "USER_3"."DIM_PROMOTIONS"
(
	"PROMO_ID" NUMBER(8,2) NOT NULL,
	"PROMO_SRC" NUMBER(8,2),
	"PROMO_CODE" NUMBER(8,2),
	"PROMO_NAME" VARCHAR2(50),
	"PROMO_DESC" VARCHAR2(50),
	"PROMO_TYPE" VARCHAR2(50),
	"PROMO_COST" NUMBER(8,2),
	"START_DT" VARCHAR2(50),
	"END_DT" VARCHAR2(50),
	"IS_ACTIVE" VARCHAR(50)
)
;

CREATE TABLE "USER_3"."DIM_SALE_STATE"
(
	"STATE_ID" NUMBER(8,2) NOT NULL,
	"STATE_DESC" VARCHAR2(50)
)
;

CREATE TABLE "USER_3"."FACT_SALES"
(
	"PRODUCT_ID" NUMBER(8,2) NOT NULL,
	"DEPARTMENT_ID" NUMBER(8,2) NOT NULL,
	"CONSUMER_ID" NUMBER(8,2) NOT NULL,
	"PROMO_ID" NUMBER(8,2) NOT NULL,
	"AMOUNT" NUMBER(8,2),
	"QUANTITY" NUMBER(8,2),
	"DATE_ID" DATE NOT NULL,
	"STATE_ID" NUMBER NOT NULL
)
;

ALTER TABLE "USER_3"."DIM_CONSUMERS" 
 ADD CONSTRAINT "PK_CONSUMERS"
	PRIMARY KEY ("CONSUMER_ID") USING INDEX
;

ALTER TABLE "USER_3"."DIM_DATE" 
 ADD CONSTRAINT "PK_TIME"
	PRIMARY KEY ("DATE_ID") USING INDEX
;

ALTER TABLE "USER_3"."DIM_DEPARTMENTS" 
 ADD CONSTRAINT "PK_DEPARTMENTS"
	PRIMARY KEY ("DEPARTMENT_ID") USING INDEX
;

ALTER TABLE "USER_3"."DIM_PRODUCTS" 
 ADD CONSTRAINT "PK_TABLE1"
	PRIMARY KEY ("PRODUCT_ID") USING INDEX
;

ALTER TABLE "USER_3"."DIM_PROMOTIONS" 
 ADD CONSTRAINT "PK_PROMOTION"
	PRIMARY KEY ("PROMO_ID") USING INDEX
;

ALTER TABLE "USER_3"."DIM_SALE_STATE" 
 ADD CONSTRAINT "PK_SALE_STATE"
	PRIMARY KEY ("STATE_ID") USING INDEX
;

CREATE INDEX "IXFK_FACT_SALES
_SALE_STATE"   
 ON "USER_3"."FACT_SALES" ("STATE_ID") 
;

ALTER TABLE "USER_3"."FACT_SALES" 
 ADD CONSTRAINT "PK"
	PRIMARY KEY ("PRODUCT_ID","DEPARTMENT_ID","CONSUMER_ID","PROMO_ID","DATE_ID","STATE_ID") USING INDEX
;

ALTER TABLE "USER_3"."FACT_SALES" 
 ADD CONSTRAINT "FK_FACT_SALES
_CONSUMERS"
	FOREIGN KEY ("CONSUMER_ID") REFERENCES "USER_3"."DIM_CONSUMERS" ("CONSUMER_ID")
;

ALTER TABLE "USER_3"."FACT_SALES" 
 ADD CONSTRAINT "FK_FACT_SALES
_DEPARTMENTS"
	FOREIGN KEY ("DEPARTMENT_ID") REFERENCES "USER_3"."DIM_DEPARTMENTS" ("DEPARTMENT_ID")
;

ALTER TABLE "USER_3"."FACT_SALES" 
 ADD CONSTRAINT "FK_FACT_SALES
_PRODUCTS"
	FOREIGN KEY ("PRODUCT_ID") REFERENCES "USER_3"."DIM_PRODUCTS" ("PRODUCT_ID")
;

ALTER TABLE "USER_3"."FACT_SALES" 
 ADD CONSTRAINT "FK_FACT_SALES
_PROMOTION"
	FOREIGN KEY ("PROMO_ID") REFERENCES "USER_3"."DIM_PROMOTIONS" ("PROMO_ID")
;

ALTER TABLE "USER_3"."FACT_SALES" 
 ADD CONSTRAINT "FK_FACT_SALES
_SALE_STATE"
	FOREIGN KEY ("STATE_ID") REFERENCES "USER_3"."DIM_SALE_STATE" ("STATE_ID")
;

ALTER TABLE "USER_3"."FACT_SALES" 
 ADD CONSTRAINT "FK_FACT_SALES
_TIME"
	FOREIGN KEY ("DATE_ID") REFERENCES "USER_3"."DIM_DATE" ("DATE_ID")
;
